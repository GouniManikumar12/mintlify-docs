# CPA Conversion Event Schema

## Overview
Event fired when a user completes a conversion action (signup, purchase, etc.).

## Required Fields
| Field | Type | Description |
|--------|------|-------------|
| `event_type` | string | Event type identifier (always `cpa_conversion`) |
| `serve_token` | string | Serve token from the auction result |
| `conversion_id` | string | Unique identifier for this conversion |
| `conversion_type` | string | Type of conversion action. Enum: `signup`, `purchase`, `trial_start`, `demo_request`, `download`, `custom` |
| `ts` | string | ISO 8601 timestamp of the conversion |

## Optional Fields
| Field | Type | Description |
|--------|------|-------------|
| `order_value_cents` | integer | Order value in cents (for purchase conversions, minimum: 0) |
| `currency` | string | Currency code for order value (pattern: `^[A-Z]{3}$`) |
| `conversion_metadata` | object | Additional conversion context |

## Conversion Metadata Object
| Field | Type | Description |
|--------|------|-------------|
| `user_id` | string | Advertiser's internal user ID |
| `order_id` | string | Order or transaction ID |
| `product_ids` | array | List of product IDs purchased (array of strings) |

## Example
```json
{
  "event_type": "cpa_conversion",
  "serve_token": "stk_abcxyz123",
  "conversion_id": "cnv_001",
  "conversion_type": "signup",
  "order_value_cents": 4900,
  "currency": "USD",
  "conversion_metadata": {
    "user_id": "usr_12345",
    "order_id": "ord_67890",
    "product_ids": ["prod_crm_pro", "prod_addon_analytics"]
  },
  "ts": "2025-11-11T18:30:00Z"
}
```

## Validation Rules
- `event_type` must be exactly `cpa_conversion`
- `conversion_type` must be one of: `signup`, `purchase`, `trial_start`, `demo_request`, `download`, `custom`
- `order_value_cents` must be at least 0
- `currency` must match pattern: `^[A-Z]{3}$`
- `ts` must be in ISO 8601 date-time format
