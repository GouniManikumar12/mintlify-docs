{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CPAConversionEvent",
  "description": "Event fired when a user completes a conversion action (signup, purchase, etc.)",
  "type": "object",
  "required": ["event_type", "serve_token", "conversion_id", "conversion_type", "ts"],
  "properties": {
    "event_type": {
      "type": "string",
      "const": "cpa_conversion",
      "description": "Event type identifier"
    },
    "serve_token": {
      "type": "string",
      "description": "Serve token from the auction result",
      "example": "stk_abcxyz123"
    },
    "conversion_id": {
      "type": "string",
      "description": "Unique identifier for this conversion",
      "example": "cnv_001"
    },
    "conversion_type": {
      "type": "string",
      "description": "Type of conversion action",
      "enum": ["signup", "purchase", "trial_start", "demo_request", "download", "custom"],
      "example": "signup"
    },
    "order_value_cents": {
      "type": "integer",
      "description": "Order value in cents (for purchase conversions)",
      "minimum": 0,
      "example": 4900
    },
    "currency": {
      "type": "string",
      "description": "Currency code for order value",
      "pattern": "^[A-Z]{3}$",
      "example": "USD"
    },
    "conversion_metadata": {
      "type": "object",
      "description": "Additional conversion context",
      "properties": {
        "user_id": {
          "type": "string",
          "description": "Advertiser's internal user ID",
          "example": "usr_12345"
        },
        "order_id": {
          "type": "string",
          "description": "Order or transaction ID",
          "example": "ord_67890"
        },
        "product_ids": {
          "type": "array",
          "description": "List of product IDs purchased",
          "items": {
            "type": "string"
          },
          "example": ["prod_crm_pro", "prod_addon_analytics"]
        }
      }
    },
    "ts": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of the conversion",
      "example": "2025-11-11T18:30:00Z"
    }
  },
  "examples": [
    {
      "event_type": "cpa_conversion",
      "serve_token": "stk_abcxyz123",
      "conversion_id": "cnv_001",
      "conversion_type": "signup",
      "order_value_cents": 4900,
      "currency": "USD",
      "conversion_metadata": {
        "user_id": "usr_12345",
        "order_id": "ord_67890",
        "product_ids": ["prod_crm_pro", "prod_addon_analytics"]
      },
      "ts": "2025-11-11T18:30:00Z"
    }
  ]
}

